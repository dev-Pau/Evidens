[debug] [2022-09-03T14:16:59.786Z] ----------------------------------------------------------------------
[debug] [2022-09-03T14:16:59.787Z] Command:       /usr/local/bin/firebase /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase deploy --only functions:sendNotification
[debug] [2022-09-03T14:16:59.787Z] CLI Version:   11.7.0
[debug] [2022-09-03T14:16:59.787Z] Platform:      darwin
[debug] [2022-09-03T14:16:59.787Z] Node Version:  v16.16.0
[debug] [2022-09-03T14:16:59.788Z] Time:          Sat Sep 03 2022 16:16:59 GMT+0200 (Central European Summer Time)
[debug] [2022-09-03T14:16:59.789Z] ----------------------------------------------------------------------
[debug] 
[debug] [2022-09-03T14:16:59.838Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2022-09-03T14:16:59.838Z] > authorizing via signed-in user (paucryptoc@gmail.com)
[debug] [2022-09-03T14:16:59.838Z] [iam] checking project evidens-ec6bd for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2022-09-03T14:16:59.840Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions [none]
[debug] [2022-09-03T14:16:59.840Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions x-goog-quota-user=projects/evidens-ec6bd
[debug] [2022-09-03T14:16:59.841Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:17:00.783Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions 200
[debug] [2022-09-03T14:17:00.783Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:17:00.784Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2022-09-03T14:17:00.784Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2022-09-03T14:17:01.578Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2022-09-03T14:17:01.578Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'evidens-ec6bd'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[debug] [2022-09-03T14:17:02.587Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:17:02.908Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:17:02.908Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2022-09-03T14:17:02.911Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [none]
[debug] [2022-09-03T14:17:02.913Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [none]
[debug] [2022-09-03T14:17:02.914Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [none]
[debug] [2022-09-03T14:17:02.915Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [none]
[debug] [2022-09-03T14:17:03.913Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com 200
[debug] [2022-09-03T14:17:03.913Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [omitted]
[debug] [2022-09-03T14:17:03.914Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com 200
[debug] [2022-09-03T14:17:03.914Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2022-09-03T14:17:03.916Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com 200
[debug] [2022-09-03T14:17:03.916Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2022-09-03T14:17:03.917Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com 200
[debug] [2022-09-03T14:17:03.917Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2022-09-03T14:17:03.917Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig [none]
[debug] [2022-09-03T14:17:04.200Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig 200
[debug] [2022-09-03T14:17:04.200Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig {"projectId":"evidens-ec6bd","databaseURL":"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"}
[debug] [2022-09-03T14:17:04.201Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs [none]
[debug] [2022-09-03T14:17:05.029Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs 200
[debug] [2022-09-03T14:17:05.029Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs {"configs":[{"name":"projects/evidens-ec6bd/configs/algolia"}]}
[debug] [2022-09-03T14:17:05.029Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables [none]
[debug] [2022-09-03T14:17:05.816Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables 200
[debug] [2022-09-03T14:17:05.817Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables {"variables":[{"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z"},{"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z"}]}
[debug] [2022-09-03T14:17:05.817Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey [none]
[debug] [2022-09-03T14:17:05.819Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid [none]
[debug] [2022-09-03T14:17:06.209Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid 200
[debug] [2022-09-03T14:17:06.209Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid {"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z","text":"1CZMK6HJ7G"}
[debug] [2022-09-03T14:17:06.634Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey 200
[debug] [2022-09-03T14:17:06.635Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey {"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z","text":"c8cf46cb26959992339983f875a4343e"}
[info] i  functions: preparing codebase default for deployment 
[debug] [2022-09-03T14:17:06.638Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[debug] [2022-09-03T14:17:08.151Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "14"
  },
  "main": "index.js",
  "dependencies": {
    "algoliasearch": "^4.14.2",
    "cors": "^2.8.5",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^6.7.2"
  },
  "devDependencies": {
    "@types/nodemailer": "^6.4.4",
    "eslint": "^7.6.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2022-09-03T14:17:08.151Z] Building nodejs source
[warn] ⚠  functions: You are using an old version of firebase-functions SDK (3.16.0). Please update firebase-functions SDK to >=3.20.0 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/pau/Desktop/Evidens App/functions (80.3 KB) for uploading 
[debug] [2022-09-03T14:17:08.473Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:17:09.085Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:17:09.086Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions {"functions":[{"name":"projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/cases/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"caseOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:37:09.858Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/0bd916e6-d75a-4792-b5a5-e397118f0fb9.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"81201660-a754-4872-92f0-604c45a73b54","buildName":"projects/200647345557/locations/us-central1/builds/81201660-a754-4872-92f0-604c45a73b54","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:16:44.563Z","versionId":"5","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/918bb6a5-b78a-4c2f-9eb6-2a016904e0dc.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"d238d4b4-bc78-4f85-887b-990163127eb2","buildName":"projects/200647345557/locations/us-central1/builds/d238d4b4-bc78-4f85-887b-990163127eb2","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnDelete","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-09-03T14:12:27.852Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/af46e2a1-10b1-4da5-9e32-8764d7fc9cf5.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"74cd620f-47d2-4b81-b02e-c74ab06042d9","buildName":"projects/200647345557/locations/us-central1/builds/74cd620f-47d2-4b81-b02e-c74ab06042d9","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/evidens-ec6bd/databases/(default)/documents/users/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"userOnUpdate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T06:11:43.616Z","versionId":"2","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/32d3c583-fe2f-4505-bc15-e0685855d240.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"146ee90e-e16b-4564-b509-00e5e2ce59ed","buildName":"projects/200647345557/locations/us-central1/builds/146ee90e-e16b-4564-b509-00e5e2ce59ed","dockerRegistry":"ARTIFACT_REGISTRY"}]}
[debug] [2022-09-03T14:17:09.087Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:17:10.121Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:17:10.122Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions {}
[debug] [2022-09-03T14:17:10.131Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:17:10.396Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:17:10.396Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[debug] [2022-09-03T14:17:10.397Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2022-09-03T14:17:10.397Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {}
[debug] [2022-09-03T14:17:11.106Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl 200
[debug] [2022-09-03T14:17:11.106Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216431&Signature=L%2FDyZQSzBWa4F7sA%2F2VFX0gF09ovVOrmupFh0uAWjXRPckwkmUMjxTR4kuBNMxaIBCZVXqtI8JBhTR5AKNZNSvlgjZrjFYFEtCbMawPyvyxX1I%2Bpnz1lI7IhhQI3TVK09Pvmsr%2B%2FAyg741hTfoJi5zFJubA5gMHLkxfYBafAYH%2BRFInq3UOO%2FX2CDFSBqruB4RkG6mCku5lILmaxHcDrzhD8ksz5DxgMOkLrDQv8781w0DlrSOEKd%2Bi%2FvLOI1AAF8FyzU2XQNg0ks28LgerzPwRvLvMm9i4qbbFyfw5aEx0isqCOrTiEzduBTIc3tHGmH%2BfEsM4w6Aq%2BlB%2BGMLwMaw%3D%3D"}
[debug] [2022-09-03T14:17:11.107Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip GoogleAccessId=service-200647345557%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216431&Signature=L%2FDyZQSzBWa4F7sA%2F2VFX0gF09ovVOrmupFh0uAWjXRPckwkmUMjxTR4kuBNMxaIBCZVXqtI8JBhTR5AKNZNSvlgjZrjFYFEtCbMawPyvyxX1I%2Bpnz1lI7IhhQI3TVK09Pvmsr%2B%2FAyg741hTfoJi5zFJubA5gMHLkxfYBafAYH%2BRFInq3UOO%2FX2CDFSBqruB4RkG6mCku5lILmaxHcDrzhD8ksz5DxgMOkLrDQv8781w0DlrSOEKd%2Bi%2FvLOI1AAF8FyzU2XQNg0ks28LgerzPwRvLvMm9i4qbbFyfw5aEx0isqCOrTiEzduBTIc3tHGmH%2BfEsM4w6Aq%2BlB%2BGMLwMaw%3D%3D
[debug] [2022-09-03T14:17:11.107Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip [stream]
[debug] [2022-09-03T14:17:11.753Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip 200
[debug] [2022-09-03T14:17:11.753Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 14 function sendNotification(us-central1)... 
[debug] [2022-09-03T14:17:11.758Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions [none]
[debug] [2022-09-03T14:17:11.758Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"name":"projects/evidens-ec6bd/locations/us-central1/functions/sendNotification","sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/92888541-562e-47e1-9d74-8008db7ab0ce.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216431&Signature=L%2FDyZQSzBWa4F7sA%2F2VFX0gF09ovVOrmupFh0uAWjXRPckwkmUMjxTR4kuBNMxaIBCZVXqtI8JBhTR5AKNZNSvlgjZrjFYFEtCbMawPyvyxX1I%2Bpnz1lI7IhhQI3TVK09Pvmsr%2B%2FAyg741hTfoJi5zFJubA5gMHLkxfYBafAYH%2BRFInq3UOO%2FX2CDFSBqruB4RkG6mCku5lILmaxHcDrzhD8ksz5DxgMOkLrDQv8781w0DlrSOEKd%2Bi%2FvLOI1AAF8FyzU2XQNg0ks28LgerzPwRvLvMm9i4qbbFyfw5aEx0isqCOrTiEzduBTIc3tHGmH%2BfEsM4w6Aq%2BlB%2BGMLwMaw%3D%3D","entryPoint":"sendNotification","runtime":"nodejs14","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase"},"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"},"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"}}
[debug] [2022-09-03T14:17:12.135Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions 400
[debug] [2022-09-03T14:17:12.135Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"error":{"code":400,"message":"The request has errors","status":"INVALID_ARGUMENT","details":[{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"event_trigger","description":"Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"}]}]}}
[warn] ⚠  functions: failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification 
[error] Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:17:12.141Z] Total Function Deployment time: 380
[debug] [2022-09-03T14:17:12.142Z] 1 Functions Deployed
[debug] [2022-09-03T14:17:12.142Z] 1 Functions Errored
[debug] [2022-09-03T14:17:12.142Z] 0 Function Deployments Aborted
[debug] [2022-09-03T14:17:12.142Z] Average Function Deployment time: 380
[info] 
[info] Functions deploy had errors with the following functions:
	sendNotification(us-central1)
[info] i  functions: cleaning up build files... 
[debug] [2022-09-03T14:17:12.326Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email [none]
[debug] [2022-09-03T14:17:12.327Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete [none]
[debug] [2022-09-03T14:17:12.328Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification [none]
[debug] [2022-09-03T14:17:12.329Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create [none]
[debug] [2022-09-03T14:17:12.330Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create [none]
[debug] [2022-09-03T14:17:12.331Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update [none]
[debug] [2022-09-03T14:17:12.331Z] >>> [apiv2][query] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list [none]
[debug] [2022-09-03T14:17:12.916Z] <<< [apiv2][status] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list 200
[debug] [2022-09-03T14:17:12.917Z] <<< [apiv2][body] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list {"child":[],"manifest":{},"name":"evidens-ec6bd/gcf/us-central1","tags":[]}
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendWelcomeEmail
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate
[debug] [2022-09-03T14:17:12.917Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate
[debug] [2022-09-03T14:17:13.216Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification 404
[debug] [2022-09-03T14:17:13.216Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.217Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete 404
[debug] [2022-09-03T14:17:13.217Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.218Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create 404
[debug] [2022-09-03T14:17:13.218Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.219Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email 404
[debug] [2022-09-03T14:17:13.219Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.219Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create 404
[debug] [2022-09-03T14:17:13.220Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.322Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update 404
[debug] [2022-09-03T14:17:13.322Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:17:13.322Z] Functions deploy failed.
[debug] [2022-09-03T14:17:13.323Z] {
  "endpoint": {
    "id": "sendNotification",
    "project": "evidens-ec6bd",
    "region": "us-central1",
    "entryPoint": "sendNotification",
    "platform": "gcfv1",
    "runtime": "nodejs14",
    "eventTrigger": {
      "eventType": "providers/cloud.firestore/eventTypes/document.create",
      "retry": false,
      "eventFilters": {
        "resource": "projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"
      }
    },
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}",
      "GCLOUD_PROJECT": "evidens-ec6bd"
    },
    "codebase": "default",
    "labels": {
      "deployment-tool": "cli-firebase"
    }
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "context": {
      "function": "projects/evidens-ec6bd/locations/us-central1/functions/sendNotification"
    },
    "exit": 1,
    "message": "Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification",
    "original": {
      "name": "FirebaseError",
      "children": [],
      "context": {
        "body": {
          "error": {
            "code": 400,
            "message": "The request has errors",
            "status": "INVALID_ARGUMENT",
            "details": [
              {
                "@type": "type.googleapis.com/google.rpc.BadRequest",
                "fieldViolations": [
                  {
                    "field": "event_trigger",
                    "description": "Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"
                  }
                ]
              }
            ]
          }
        },
        "response": {
          "statusCode": 400
        }
      },
      "exit": 1,
      "message": "HTTP Error: 400, The request has errors",
      "status": 400
    },
    "status": 500
  }
}
[debug] [2022-09-03T14:17:13.434Z] Error: Failed to create function sendNotification in region us-central1
    at /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:42:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Fabricator.createV1Function (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:169:32)
    at async Fabricator.createEndpoint (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:120:13)
    at async handle (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:79:17)
[error] 
[error] Error: There was an error deploying functions
[debug] [2022-09-03T14:18:20.772Z] ----------------------------------------------------------------------
[debug] [2022-09-03T14:18:20.773Z] Command:       /usr/local/bin/firebase /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase deploy --only functions:sendNotification
[debug] [2022-09-03T14:18:20.773Z] CLI Version:   11.7.0
[debug] [2022-09-03T14:18:20.774Z] Platform:      darwin
[debug] [2022-09-03T14:18:20.774Z] Node Version:  v16.16.0
[debug] [2022-09-03T14:18:20.774Z] Time:          Sat Sep 03 2022 16:18:20 GMT+0200 (Central European Summer Time)
[debug] [2022-09-03T14:18:20.775Z] ----------------------------------------------------------------------
[debug] 
[debug] [2022-09-03T14:18:20.819Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2022-09-03T14:18:20.820Z] > authorizing via signed-in user (paucryptoc@gmail.com)
[debug] [2022-09-03T14:18:20.820Z] [iam] checking project evidens-ec6bd for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2022-09-03T14:18:20.821Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions [none]
[debug] [2022-09-03T14:18:20.822Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions x-goog-quota-user=projects/evidens-ec6bd
[debug] [2022-09-03T14:18:20.822Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:18:21.691Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions 200
[debug] [2022-09-03T14:18:21.691Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:18:21.692Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2022-09-03T14:18:21.692Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2022-09-03T14:18:22.373Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2022-09-03T14:18:22.374Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'evidens-ec6bd'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[debug] [2022-09-03T14:18:23.385Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:18:23.681Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:18:23.681Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2022-09-03T14:18:23.683Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [none]
[debug] [2022-09-03T14:18:23.685Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [none]
[debug] [2022-09-03T14:18:23.686Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [none]
[debug] [2022-09-03T14:18:23.687Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [none]
[debug] [2022-09-03T14:18:24.599Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com 200
[debug] [2022-09-03T14:18:24.599Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2022-09-03T14:18:24.600Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com 200
[debug] [2022-09-03T14:18:24.600Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2022-09-03T14:18:24.601Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com 200
[debug] [2022-09-03T14:18:24.601Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [omitted]
[debug] [2022-09-03T14:18:24.625Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com 200
[debug] [2022-09-03T14:18:24.625Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2022-09-03T14:18:24.626Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig [none]
[debug] [2022-09-03T14:18:24.950Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig 200
[debug] [2022-09-03T14:18:24.950Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig {"projectId":"evidens-ec6bd","databaseURL":"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"}
[debug] [2022-09-03T14:18:24.951Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs [none]
[debug] [2022-09-03T14:18:25.347Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs 200
[debug] [2022-09-03T14:18:25.347Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs {"configs":[{"name":"projects/evidens-ec6bd/configs/algolia"}]}
[debug] [2022-09-03T14:18:25.347Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables [none]
[debug] [2022-09-03T14:18:26.104Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables 200
[debug] [2022-09-03T14:18:26.104Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables {"variables":[{"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z"},{"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z"}]}
[debug] [2022-09-03T14:18:26.105Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey [none]
[debug] [2022-09-03T14:18:26.107Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid [none]
[debug] [2022-09-03T14:18:26.507Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid 200
[debug] [2022-09-03T14:18:26.508Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid {"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z","text":"1CZMK6HJ7G"}
[debug] [2022-09-03T14:18:26.948Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey 200
[debug] [2022-09-03T14:18:26.949Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey {"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z","text":"c8cf46cb26959992339983f875a4343e"}
[info] i  functions: preparing codebase default for deployment 
[debug] [2022-09-03T14:18:26.952Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[debug] [2022-09-03T14:18:28.553Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "14"
  },
  "main": "index.js",
  "dependencies": {
    "algoliasearch": "^4.14.2",
    "cors": "^2.8.5",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^6.7.2"
  },
  "devDependencies": {
    "@types/nodemailer": "^6.4.4",
    "eslint": "^7.6.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2022-09-03T14:18:28.553Z] Building nodejs source
[warn] ⚠  functions: You are using an old version of firebase-functions SDK (3.16.0). Please update firebase-functions SDK to >=3.20.0 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/pau/Desktop/Evidens App/functions (80.4 KB) for uploading 
[debug] [2022-09-03T14:18:28.799Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:18:29.432Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:18:29.433Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions {"functions":[{"name":"projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/cases/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"caseOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:37:09.858Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/0bd916e6-d75a-4792-b5a5-e397118f0fb9.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"81201660-a754-4872-92f0-604c45a73b54","buildName":"projects/200647345557/locations/us-central1/builds/81201660-a754-4872-92f0-604c45a73b54","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:16:44.563Z","versionId":"5","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/918bb6a5-b78a-4c2f-9eb6-2a016904e0dc.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"d238d4b4-bc78-4f85-887b-990163127eb2","buildName":"projects/200647345557/locations/us-central1/builds/d238d4b4-bc78-4f85-887b-990163127eb2","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnDelete","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-09-03T14:12:27.852Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/af46e2a1-10b1-4da5-9e32-8764d7fc9cf5.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"74cd620f-47d2-4b81-b02e-c74ab06042d9","buildName":"projects/200647345557/locations/us-central1/builds/74cd620f-47d2-4b81-b02e-c74ab06042d9","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/evidens-ec6bd/databases/(default)/documents/users/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"userOnUpdate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T06:11:43.616Z","versionId":"2","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/32d3c583-fe2f-4505-bc15-e0685855d240.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"146ee90e-e16b-4564-b509-00e5e2ce59ed","buildName":"projects/200647345557/locations/us-central1/builds/146ee90e-e16b-4564-b509-00e5e2ce59ed","dockerRegistry":"ARTIFACT_REGISTRY"}]}
[debug] [2022-09-03T14:18:29.434Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:18:30.521Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:18:30.522Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions {}
[debug] [2022-09-03T14:18:30.530Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:18:30.919Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:18:30.920Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[debug] [2022-09-03T14:18:30.921Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2022-09-03T14:18:30.921Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {}
[debug] [2022-09-03T14:18:31.615Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl 200
[debug] [2022-09-03T14:18:31.615Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216511&Signature=C%2Fh9fi2vPjK3Jhne%2FuiN%2BHdZW7s3GiOXtjFgtssCLxKMrzSiXaxjh6trrtVWD5UrpauKn9wO2tViOo3Kkqfkgl1Hmhv5fZYeFaHvfhHeML5g1RjKkw0T6ty59DJkS0RkNGlHsQAItkbljGqH0q0tJjrmAgrT93PA63E%2BSKcNpzNpWZOYQYsDYxajcQic32Ep%2FNiNxVHt6Y81CyQZKLZ4hf6fFMcnfoAoou12QoF3kecMmpB%2Fr7fFsOjuU9uaYwyouf1LgLcnChkiP9huO4HWBHG5kqGzV4tC9fyVZFfW9GzSmWZ7hzwC4nQgTxItFlXXk%2B0RbTyxH8iYzrLZFxQNFQ%3D%3D"}
[debug] [2022-09-03T14:18:31.618Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip GoogleAccessId=service-200647345557%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216511&Signature=C%2Fh9fi2vPjK3Jhne%2FuiN%2BHdZW7s3GiOXtjFgtssCLxKMrzSiXaxjh6trrtVWD5UrpauKn9wO2tViOo3Kkqfkgl1Hmhv5fZYeFaHvfhHeML5g1RjKkw0T6ty59DJkS0RkNGlHsQAItkbljGqH0q0tJjrmAgrT93PA63E%2BSKcNpzNpWZOYQYsDYxajcQic32Ep%2FNiNxVHt6Y81CyQZKLZ4hf6fFMcnfoAoou12QoF3kecMmpB%2Fr7fFsOjuU9uaYwyouf1LgLcnChkiP9huO4HWBHG5kqGzV4tC9fyVZFfW9GzSmWZ7hzwC4nQgTxItFlXXk%2B0RbTyxH8iYzrLZFxQNFQ%3D%3D
[debug] [2022-09-03T14:18:31.618Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip [stream]
[debug] [2022-09-03T14:18:32.275Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip 200
[debug] [2022-09-03T14:18:32.275Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 14 function sendNotification(us-central1)... 
[debug] [2022-09-03T14:18:32.281Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions [none]
[debug] [2022-09-03T14:18:32.281Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"name":"projects/evidens-ec6bd/locations/us-central1/functions/sendNotification","sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/bff1d1d3-0b2c-4161-95ad-a54425707276.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216511&Signature=C%2Fh9fi2vPjK3Jhne%2FuiN%2BHdZW7s3GiOXtjFgtssCLxKMrzSiXaxjh6trrtVWD5UrpauKn9wO2tViOo3Kkqfkgl1Hmhv5fZYeFaHvfhHeML5g1RjKkw0T6ty59DJkS0RkNGlHsQAItkbljGqH0q0tJjrmAgrT93PA63E%2BSKcNpzNpWZOYQYsDYxajcQic32Ep%2FNiNxVHt6Y81CyQZKLZ4hf6fFMcnfoAoou12QoF3kecMmpB%2Fr7fFsOjuU9uaYwyouf1LgLcnChkiP9huO4HWBHG5kqGzV4tC9fyVZFfW9GzSmWZ7hzwC4nQgTxItFlXXk%2B0RbTyxH8iYzrLZFxQNFQ%3D%3D","entryPoint":"sendNotification","runtime":"nodejs14","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase"},"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"},"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"}}
[debug] [2022-09-03T14:18:32.632Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions 400
[debug] [2022-09-03T14:18:32.633Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"error":{"code":400,"message":"The request has errors","status":"INVALID_ARGUMENT","details":[{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"event_trigger","description":"Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"}]}]}}
[warn] ⚠  functions: failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification 
[error] Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:18:32.639Z] Total Function Deployment time: 355
[debug] [2022-09-03T14:18:32.639Z] 1 Functions Deployed
[debug] [2022-09-03T14:18:32.639Z] 1 Functions Errored
[debug] [2022-09-03T14:18:32.639Z] 0 Function Deployments Aborted
[debug] [2022-09-03T14:18:32.639Z] Average Function Deployment time: 355
[info] 
[info] Functions deploy had errors with the following functions:
	sendNotification(us-central1)
[info] i  functions: cleaning up build files... 
[debug] [2022-09-03T14:18:32.741Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email [none]
[debug] [2022-09-03T14:18:32.742Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete [none]
[debug] [2022-09-03T14:18:32.743Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification [none]
[debug] [2022-09-03T14:18:32.744Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create [none]
[debug] [2022-09-03T14:18:32.745Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create [none]
[debug] [2022-09-03T14:18:32.745Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update [none]
[debug] [2022-09-03T14:18:32.746Z] >>> [apiv2][query] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list [none]
[debug] [2022-09-03T14:18:33.222Z] <<< [apiv2][status] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list 200
[debug] [2022-09-03T14:18:33.222Z] <<< [apiv2][body] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list {"child":[],"manifest":{},"name":"evidens-ec6bd/gcf/us-central1","tags":[]}
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendWelcomeEmail
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate
[debug] [2022-09-03T14:18:33.223Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate
[debug] [2022-09-03T14:18:33.479Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification 404
[debug] [2022-09-03T14:18:33.479Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.484Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create 404
[debug] [2022-09-03T14:18:33.484Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.485Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update 404
[debug] [2022-09-03T14:18:33.485Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.491Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email 404
[debug] [2022-09-03T14:18:33.491Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.491Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete 404
[debug] [2022-09-03T14:18:33.491Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.492Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create 404
[debug] [2022-09-03T14:18:33.492Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:18:33.492Z] Functions deploy failed.
[debug] [2022-09-03T14:18:33.492Z] {
  "endpoint": {
    "id": "sendNotification",
    "project": "evidens-ec6bd",
    "region": "us-central1",
    "entryPoint": "sendNotification",
    "platform": "gcfv1",
    "runtime": "nodejs14",
    "eventTrigger": {
      "eventType": "providers/cloud.firestore/eventTypes/document.create",
      "retry": false,
      "eventFilters": {
        "resource": "projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"
      }
    },
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}",
      "GCLOUD_PROJECT": "evidens-ec6bd"
    },
    "codebase": "default",
    "labels": {
      "deployment-tool": "cli-firebase"
    }
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "context": {
      "function": "projects/evidens-ec6bd/locations/us-central1/functions/sendNotification"
    },
    "exit": 1,
    "message": "Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification",
    "original": {
      "name": "FirebaseError",
      "children": [],
      "context": {
        "body": {
          "error": {
            "code": 400,
            "message": "The request has errors",
            "status": "INVALID_ARGUMENT",
            "details": [
              {
                "@type": "type.googleapis.com/google.rpc.BadRequest",
                "fieldViolations": [
                  {
                    "field": "event_trigger",
                    "description": "Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"
                  }
                ]
              }
            ]
          }
        },
        "response": {
          "statusCode": 400
        }
      },
      "exit": 1,
      "message": "HTTP Error: 400, The request has errors",
      "status": 400
    },
    "status": 500
  }
}
[debug] [2022-09-03T14:18:33.587Z] Error: Failed to create function sendNotification in region us-central1
    at /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:42:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Fabricator.createV1Function (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:169:32)
    at async Fabricator.createEndpoint (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:120:13)
    at async handle (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:79:17)
[error] 
[error] Error: There was an error deploying functions
[debug] [2022-09-03T14:19:31.104Z] ----------------------------------------------------------------------
[debug] [2022-09-03T14:19:31.105Z] Command:       /usr/local/bin/firebase /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase deploy --only functions:sendNotification
[debug] [2022-09-03T14:19:31.106Z] CLI Version:   11.7.0
[debug] [2022-09-03T14:19:31.106Z] Platform:      darwin
[debug] [2022-09-03T14:19:31.106Z] Node Version:  v16.16.0
[debug] [2022-09-03T14:19:31.107Z] Time:          Sat Sep 03 2022 16:19:31 GMT+0200 (Central European Summer Time)
[debug] [2022-09-03T14:19:31.107Z] ----------------------------------------------------------------------
[debug] 
[debug] [2022-09-03T14:19:31.153Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2022-09-03T14:19:31.153Z] > authorizing via signed-in user (paucryptoc@gmail.com)
[debug] [2022-09-03T14:19:31.153Z] [iam] checking project evidens-ec6bd for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2022-09-03T14:19:31.155Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions [none]
[debug] [2022-09-03T14:19:31.155Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions x-goog-quota-user=projects/evidens-ec6bd
[debug] [2022-09-03T14:19:31.155Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:19:31.951Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions 200
[debug] [2022-09-03T14:19:31.951Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:19:31.952Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2022-09-03T14:19:31.952Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2022-09-03T14:19:32.633Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2022-09-03T14:19:32.633Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'evidens-ec6bd'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[debug] [2022-09-03T14:19:33.647Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:19:34.042Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:19:34.042Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2022-09-03T14:19:34.045Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [none]
[debug] [2022-09-03T14:19:34.046Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [none]
[debug] [2022-09-03T14:19:34.047Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [none]
[debug] [2022-09-03T14:19:34.048Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [none]
[debug] [2022-09-03T14:19:34.949Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com 200
[debug] [2022-09-03T14:19:34.949Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [omitted]
[debug] [2022-09-03T14:19:34.950Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com 200
[debug] [2022-09-03T14:19:34.950Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2022-09-03T14:19:34.952Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com 200
[debug] [2022-09-03T14:19:34.952Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2022-09-03T14:19:34.967Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com 200
[debug] [2022-09-03T14:19:34.967Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2022-09-03T14:19:34.967Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig [none]
[debug] [2022-09-03T14:19:35.481Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig 200
[debug] [2022-09-03T14:19:35.481Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig {"projectId":"evidens-ec6bd","databaseURL":"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"}
[debug] [2022-09-03T14:19:35.482Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs [none]
[debug] [2022-09-03T14:19:36.537Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs 200
[debug] [2022-09-03T14:19:36.537Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs {"configs":[{"name":"projects/evidens-ec6bd/configs/algolia"}]}
[debug] [2022-09-03T14:19:36.538Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables [none]
[debug] [2022-09-03T14:19:36.911Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables 200
[debug] [2022-09-03T14:19:36.912Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables {"variables":[{"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z"},{"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z"}]}
[debug] [2022-09-03T14:19:36.912Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey [none]
[debug] [2022-09-03T14:19:36.913Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid [none]
[debug] [2022-09-03T14:19:37.476Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid 200
[debug] [2022-09-03T14:19:37.476Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid {"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z","text":"1CZMK6HJ7G"}
[debug] [2022-09-03T14:19:37.901Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey 200
[debug] [2022-09-03T14:19:37.902Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey {"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z","text":"c8cf46cb26959992339983f875a4343e"}
[info] i  functions: preparing codebase default for deployment 
[debug] [2022-09-03T14:19:37.903Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[debug] [2022-09-03T14:19:39.774Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "14"
  },
  "main": "index.js",
  "dependencies": {
    "algoliasearch": "^4.14.2",
    "cors": "^2.8.5",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^6.7.2"
  },
  "devDependencies": {
    "@types/nodemailer": "^6.4.4",
    "eslint": "^7.6.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2022-09-03T14:19:39.775Z] Building nodejs source
[warn] ⚠  functions: You are using an old version of firebase-functions SDK (3.16.0). Please update firebase-functions SDK to >=3.20.0 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/pau/Desktop/Evidens App/functions (80.4 KB) for uploading 
[debug] [2022-09-03T14:19:40.103Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:19:40.669Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:19:40.669Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions {"functions":[{"name":"projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/cases/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"caseOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:37:09.858Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/0bd916e6-d75a-4792-b5a5-e397118f0fb9.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"81201660-a754-4872-92f0-604c45a73b54","buildName":"projects/200647345557/locations/us-central1/builds/81201660-a754-4872-92f0-604c45a73b54","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:16:44.563Z","versionId":"5","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/918bb6a5-b78a-4c2f-9eb6-2a016904e0dc.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"d238d4b4-bc78-4f85-887b-990163127eb2","buildName":"projects/200647345557/locations/us-central1/builds/d238d4b4-bc78-4f85-887b-990163127eb2","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnDelete","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-09-03T14:12:27.852Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/af46e2a1-10b1-4da5-9e32-8764d7fc9cf5.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"74cd620f-47d2-4b81-b02e-c74ab06042d9","buildName":"projects/200647345557/locations/us-central1/builds/74cd620f-47d2-4b81-b02e-c74ab06042d9","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/evidens-ec6bd/databases/(default)/documents/users/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"userOnUpdate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T06:11:43.616Z","versionId":"2","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/32d3c583-fe2f-4505-bc15-e0685855d240.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"146ee90e-e16b-4564-b509-00e5e2ce59ed","buildName":"projects/200647345557/locations/us-central1/builds/146ee90e-e16b-4564-b509-00e5e2ce59ed","dockerRegistry":"ARTIFACT_REGISTRY"}]}
[debug] [2022-09-03T14:19:40.670Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:19:41.690Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:19:41.690Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions {}
[debug] [2022-09-03T14:19:41.695Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:19:41.969Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:19:41.969Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[debug] [2022-09-03T14:19:41.970Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2022-09-03T14:19:41.970Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {}
[debug] [2022-09-03T14:19:42.631Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl 200
[debug] [2022-09-03T14:19:42.631Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216582&Signature=ArGiYLINv35%2FJ%2B8wDx0TXd93n%2FZWutu3ff%2B22cjmdMPEyFqFuHFwsg%2FUOdpgZwlkEkGlmsQviBu6PGDCsc%2FdBBwF59dxtivzHueuKisv%2BKWateIvfV8FG8iBEuBX6ps3YKyJHagiy%2BlQmK7AmyC%2B2qCUbpy1Sq0hEAHWQVxYJVKZVJu1r%2FdwuHBqksIc7kQWWLzm69zXy2pXMNVvxZNGjYntgQFCXLq4TOK5iY9Ean%2BeTKBzTLjdVViGxQCkkG%2FHk66JTEDMIIZoZT5higNbQXNtp4p7iA%2FWE%2B6igifbEmWd%2F%2FU%2FlgbPftSuw7lvuvoWsWOuHNYE24%2FU508pphoyOA%3D%3D"}
[debug] [2022-09-03T14:19:42.632Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip GoogleAccessId=service-200647345557%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216582&Signature=ArGiYLINv35%2FJ%2B8wDx0TXd93n%2FZWutu3ff%2B22cjmdMPEyFqFuHFwsg%2FUOdpgZwlkEkGlmsQviBu6PGDCsc%2FdBBwF59dxtivzHueuKisv%2BKWateIvfV8FG8iBEuBX6ps3YKyJHagiy%2BlQmK7AmyC%2B2qCUbpy1Sq0hEAHWQVxYJVKZVJu1r%2FdwuHBqksIc7kQWWLzm69zXy2pXMNVvxZNGjYntgQFCXLq4TOK5iY9Ean%2BeTKBzTLjdVViGxQCkkG%2FHk66JTEDMIIZoZT5higNbQXNtp4p7iA%2FWE%2B6igifbEmWd%2F%2FU%2FlgbPftSuw7lvuvoWsWOuHNYE24%2FU508pphoyOA%3D%3D
[debug] [2022-09-03T14:19:42.632Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip [stream]
[debug] [2022-09-03T14:19:43.559Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip 200
[debug] [2022-09-03T14:19:43.559Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 14 function sendNotification(us-central1)... 
[debug] [2022-09-03T14:19:43.564Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions [none]
[debug] [2022-09-03T14:19:43.564Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"name":"projects/evidens-ec6bd/locations/us-central1/functions/sendNotification","sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/f2902b9d-8c3f-4583-8553-df7e4445c922.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216582&Signature=ArGiYLINv35%2FJ%2B8wDx0TXd93n%2FZWutu3ff%2B22cjmdMPEyFqFuHFwsg%2FUOdpgZwlkEkGlmsQviBu6PGDCsc%2FdBBwF59dxtivzHueuKisv%2BKWateIvfV8FG8iBEuBX6ps3YKyJHagiy%2BlQmK7AmyC%2B2qCUbpy1Sq0hEAHWQVxYJVKZVJu1r%2FdwuHBqksIc7kQWWLzm69zXy2pXMNVvxZNGjYntgQFCXLq4TOK5iY9Ean%2BeTKBzTLjdVViGxQCkkG%2FHk66JTEDMIIZoZT5higNbQXNtp4p7iA%2FWE%2B6igifbEmWd%2F%2FU%2FlgbPftSuw7lvuvoWsWOuHNYE24%2FU508pphoyOA%3D%3D","entryPoint":"sendNotification","runtime":"nodejs14","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase"},"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"},"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"}}
[debug] [2022-09-03T14:19:44.062Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions 400
[debug] [2022-09-03T14:19:44.062Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"error":{"code":400,"message":"The request has errors","status":"INVALID_ARGUMENT","details":[{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"event_trigger","description":"Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"}]}]}}
[warn] ⚠  functions: failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification 
[error] Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:19:44.067Z] Total Function Deployment time: 501
[debug] [2022-09-03T14:19:44.067Z] 1 Functions Deployed
[debug] [2022-09-03T14:19:44.067Z] 1 Functions Errored
[debug] [2022-09-03T14:19:44.067Z] 0 Function Deployments Aborted
[debug] [2022-09-03T14:19:44.067Z] Average Function Deployment time: 501
[info] 
[info] Functions deploy had errors with the following functions:
	sendNotification(us-central1)
[info] i  functions: cleaning up build files... 
[debug] [2022-09-03T14:19:44.165Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email [none]
[debug] [2022-09-03T14:19:44.166Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete [none]
[debug] [2022-09-03T14:19:44.167Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification [none]
[debug] [2022-09-03T14:19:44.168Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create [none]
[debug] [2022-09-03T14:19:44.168Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create [none]
[debug] [2022-09-03T14:19:44.169Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update [none]
[debug] [2022-09-03T14:19:44.170Z] >>> [apiv2][query] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list [none]
[debug] [2022-09-03T14:19:44.394Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification 404
[debug] [2022-09-03T14:19:44.395Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.612Z] <<< [apiv2][status] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list 200
[debug] [2022-09-03T14:19:44.612Z] <<< [apiv2][body] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list {"child":[],"manifest":{},"name":"evidens-ec6bd/gcf/us-central1","tags":[]}
[debug] [2022-09-03T14:19:44.613Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendWelcomeEmail
[debug] [2022-09-03T14:19:44.613Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete
[debug] [2022-09-03T14:19:44.613Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:19:44.613Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate
[debug] [2022-09-03T14:19:44.613Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate
[debug] [2022-09-03T14:19:44.614Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate
[debug] [2022-09-03T14:19:44.910Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update 404
[debug] [2022-09-03T14:19:44.910Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.911Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete 404
[debug] [2022-09-03T14:19:44.911Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.912Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create 404
[debug] [2022-09-03T14:19:44.912Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.912Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create 404
[debug] [2022-09-03T14:19:44.912Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.913Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email 404
[debug] [2022-09-03T14:19:44.913Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:19:44.913Z] Functions deploy failed.
[debug] [2022-09-03T14:19:44.913Z] {
  "endpoint": {
    "id": "sendNotification",
    "project": "evidens-ec6bd",
    "region": "us-central1",
    "entryPoint": "sendNotification",
    "platform": "gcfv1",
    "runtime": "nodejs14",
    "eventTrigger": {
      "eventType": "providers/cloud.firestore/eventTypes/document.create",
      "retry": false,
      "eventFilters": {
        "resource": "projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"
      }
    },
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}",
      "GCLOUD_PROJECT": "evidens-ec6bd"
    },
    "codebase": "default",
    "labels": {
      "deployment-tool": "cli-firebase"
    }
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "context": {
      "function": "projects/evidens-ec6bd/locations/us-central1/functions/sendNotification"
    },
    "exit": 1,
    "message": "Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification",
    "original": {
      "name": "FirebaseError",
      "children": [],
      "context": {
        "body": {
          "error": {
            "code": 400,
            "message": "The request has errors",
            "status": "INVALID_ARGUMENT",
            "details": [
              {
                "@type": "type.googleapis.com/google.rpc.BadRequest",
                "fieldViolations": [
                  {
                    "field": "event_trigger",
                    "description": "Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"
                  }
                ]
              }
            ]
          }
        },
        "response": {
          "statusCode": 400
        }
      },
      "exit": 1,
      "message": "HTTP Error: 400, The request has errors",
      "status": 400
    },
    "status": 500
  }
}
[debug] [2022-09-03T14:19:45.006Z] Error: Failed to create function sendNotification in region us-central1
    at /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:42:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Fabricator.createV1Function (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:169:32)
    at async Fabricator.createEndpoint (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:120:13)
    at async handle (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:79:17)
[error] 
[error] Error: There was an error deploying functions
[debug] [2022-09-03T14:25:41.739Z] ----------------------------------------------------------------------
[debug] [2022-09-03T14:25:41.741Z] Command:       /usr/local/bin/firebase /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/bin/firebase deploy --only functions:sendNotification
[debug] [2022-09-03T14:25:41.741Z] CLI Version:   11.7.0
[debug] [2022-09-03T14:25:41.742Z] Platform:      darwin
[debug] [2022-09-03T14:25:41.742Z] Node Version:  v16.16.0
[debug] [2022-09-03T14:25:41.748Z] Time:          Sat Sep 03 2022 16:25:41 GMT+0200 (Central European Summer Time)
[debug] [2022-09-03T14:25:41.748Z] ----------------------------------------------------------------------
[debug] 
[debug] [2022-09-03T14:25:41.803Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2022-09-03T14:25:41.803Z] > authorizing via signed-in user (paucryptoc@gmail.com)
[debug] [2022-09-03T14:25:41.803Z] [iam] checking project evidens-ec6bd for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2022-09-03T14:25:41.806Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions [none]
[debug] [2022-09-03T14:25:41.806Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions x-goog-quota-user=projects/evidens-ec6bd
[debug] [2022-09-03T14:25:41.806Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:25:42.671Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions 200
[debug] [2022-09-03T14:25:42.671Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/evidens-ec6bd:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2022-09-03T14:25:42.672Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2022-09-03T14:25:42.672Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2022-09-03T14:25:43.416Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2022-09-03T14:25:43.416Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/evidens-ec6bd/serviceAccounts/evidens-ec6bd@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'evidens-ec6bd'...
[info] 
[info] i  deploying functions 
[info] Running command: npm --prefix "$RESOURCE_DIR" run lint
[info] ✔  functions: Finished running predeploy script. 
[debug] [2022-09-03T14:25:44.853Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:25:45.242Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:25:45.243Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2022-09-03T14:25:45.245Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [none]
[debug] [2022-09-03T14:25:45.247Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [none]
[debug] [2022-09-03T14:25:45.248Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [none]
[debug] [2022-09-03T14:25:45.249Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [none]
[debug] [2022-09-03T14:25:46.208Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com 200
[debug] [2022-09-03T14:25:46.208Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/runtimeconfig.googleapis.com [omitted]
[debug] [2022-09-03T14:25:46.210Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com 200
[debug] [2022-09-03T14:25:46.210Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudfunctions.googleapis.com [omitted]
[info] ✔  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2022-09-03T14:25:46.231Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com 200
[debug] [2022-09-03T14:25:46.232Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/artifactregistry.googleapis.com [omitted]
[info] ✔  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2022-09-03T14:25:46.262Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com 200
[debug] [2022-09-03T14:25:46.262Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/evidens-ec6bd/services/cloudbuild.googleapis.com [omitted]
[info] ✔  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2022-09-03T14:25:46.263Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig [none]
[debug] [2022-09-03T14:25:46.535Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig 200
[debug] [2022-09-03T14:25:46.536Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd/adminSdkConfig {"projectId":"evidens-ec6bd","databaseURL":"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"}
[debug] [2022-09-03T14:25:46.537Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs [none]
[debug] [2022-09-03T14:25:46.886Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs 200
[debug] [2022-09-03T14:25:46.886Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs {"configs":[{"name":"projects/evidens-ec6bd/configs/algolia"}]}
[debug] [2022-09-03T14:25:46.887Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables [none]
[debug] [2022-09-03T14:25:47.164Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables 200
[debug] [2022-09-03T14:25:47.164Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables {"variables":[{"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z"},{"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z"}]}
[debug] [2022-09-03T14:25:47.165Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey [none]
[debug] [2022-09-03T14:25:47.167Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid [none]
[debug] [2022-09-03T14:25:47.403Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey 200
[debug] [2022-09-03T14:25:47.403Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/apikey {"name":"projects/evidens-ec6bd/configs/algolia/variables/apikey","updateTime":"2022-08-20T06:47:40.409000203Z","text":"c8cf46cb26959992339983f875a4343e"}
[debug] [2022-09-03T14:25:47.407Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid 200
[debug] [2022-09-03T14:25:47.408Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/evidens-ec6bd/configs/algolia/variables/appid {"name":"projects/evidens-ec6bd/configs/algolia/variables/appid","updateTime":"2022-08-20T06:47:39.539600073Z","text":"1CZMK6HJ7G"}
[info] i  functions: preparing codebase default for deployment 
[debug] [2022-09-03T14:25:47.410Z] Validating nodejs source
[warn] ⚠  functions: package.json indicates an outdated version of firebase-functions. Please upgrade using npm install --save firebase-functions@latest in your functions directory. 
[debug] [2022-09-03T14:25:49.811Z] > [functions] package.json contents: {
  "name": "functions",
  "description": "Cloud Functions for Firebase",
  "scripts": {
    "lint": "eslint",
    "serve": "firebase emulators:start --only functions",
    "shell": "firebase functions:shell",
    "start": "npm run shell",
    "deploy": "firebase deploy --only functions",
    "logs": "firebase functions:log"
  },
  "engines": {
    "node": "14"
  },
  "main": "index.js",
  "dependencies": {
    "algoliasearch": "^4.14.2",
    "cors": "^2.8.5",
    "firebase-admin": "^9.8.0",
    "firebase-functions": "^3.14.1",
    "nodemailer": "^6.7.2"
  },
  "devDependencies": {
    "@types/nodemailer": "^6.4.4",
    "eslint": "^7.6.0",
    "eslint-config-google": "^0.14.0",
    "firebase-functions-test": "^0.2.0"
  },
  "private": true
}
[debug] [2022-09-03T14:25:49.811Z] Building nodejs source
[warn] ⚠  functions: You are using an old version of firebase-functions SDK (3.16.0). Please update firebase-functions SDK to >=3.20.0 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged /Users/pau/Desktop/Evidens App/functions (80.4 KB) for uploading 
[debug] [2022-09-03T14:25:50.096Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:25:50.701Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:25:50.701Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/-/functions {"functions":[{"name":"projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/cases/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"caseOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:37:09.858Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/0bd916e6-d75a-4792-b5a5-e397118f0fb9.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"81201660-a754-4872-92f0-604c45a73b54","buildName":"projects/200647345557/locations/us-central1/builds/81201660-a754-4872-92f0-604c45a73b54","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnCreate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T08:16:44.563Z","versionId":"5","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/918bb6a5-b78a-4c2f-9eb6-2a016904e0dc.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"d238d4b4-bc78-4f85-887b-990163127eb2","buildName":"projects/200647345557/locations/us-central1/builds/d238d4b4-bc78-4f85-887b-990163127eb2","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.delete","resource":"projects/evidens-ec6bd/databases/(default)/documents/posts/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"postOnDelete","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-09-03T14:12:27.852Z","versionId":"1","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/af46e2a1-10b1-4da5-9e32-8764d7fc9cf5.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"74cd620f-47d2-4b81-b02e-c74ab06042d9","buildName":"projects/200647345557/locations/us-central1/builds/74cd620f-47d2-4b81-b02e-c74ab06042d9","dockerRegistry":"ARTIFACT_REGISTRY"},{"name":"projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate","eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.update","resource":"projects/evidens-ec6bd/databases/(default)/documents/users/{uid}","service":"firestore.googleapis.com","failurePolicy":{}},"status":"ACTIVE","entryPoint":"userOnUpdate","timeout":"60s","availableMemoryMb":256,"serviceAccountEmail":"evidens-ec6bd@appspot.gserviceaccount.com","updateTime":"2022-08-25T06:11:43.616Z","versionId":"2","labels":{"deployment-tool":"cli-firebase"},"sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/32d3c583-fe2f-4505-bc15-e0685855d240.zip","environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"},"runtime":"nodejs14","ingressSettings":"ALLOW_ALL","buildId":"146ee90e-e16b-4564-b509-00e5e2ce59ed","buildName":"projects/200647345557/locations/us-central1/builds/146ee90e-e16b-4564-b509-00e5e2ce59ed","dockerRegistry":"ARTIFACT_REGISTRY"}]}
[debug] [2022-09-03T14:25:50.702Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions [none]
[debug] [2022-09-03T14:25:51.743Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions 200
[debug] [2022-09-03T14:25:51.744Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2alpha/projects/evidens-ec6bd/locations/-/functions {}
[debug] [2022-09-03T14:25:51.753Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd [none]
[debug] [2022-09-03T14:25:52.063Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd 200
[debug] [2022-09-03T14:25:52.063Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/evidens-ec6bd {"projectId":"evidens-ec6bd","projectNumber":"200647345557","displayName":"Evidens","name":"projects/evidens-ec6bd","resources":{"hostingSite":"evidens-ec6bd","realtimeDatabaseInstance":"evidens-ec6bd-default-rtdb","storageBucket":"evidens-ec6bd.appspot.com","locationId":"europe-west"},"state":"ACTIVE","etag":"1_059f8a10-712a-4d78-87cb-6501f7708ff9"}
[debug] [2022-09-03T14:25:52.065Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2022-09-03T14:25:52.065Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {}
[debug] [2022-09-03T14:25:52.751Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl 200
[debug] [2022-09-03T14:25:52.751Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216952&Signature=rzalngRaKbfsqrxMk3LTE%2BZma%2BWDb1vZmsqIM27kTMKCZCS0A1i4nyGw2RcT2PM4npFYGpGwpTWAuaopmoykohU0iX%2F6XuD23EwtP6LQ7cr9AfSCOso1t3mkpZypCF0%2FaL%2BQyejkPkHWf6AC%2BTsXCSSyNp3DEl3t3VWPLoO7ylnctwNaow9b8x62seJM%2BepAdKFwVG0tUSyjDtugOnoUiouvxHPm2k44fTFQn2kaG7nn7VwCOWkpJPQlXa1pv%2ByeBwel703JXuN4qf%2BPzxHLSE1WMUa8ZFtrAG5u4tNGrkST2lzIMf%2BrF0kLWd1322D7ErJFath2tW0Gfy9P0n5Csg%3D%3D"}
[debug] [2022-09-03T14:25:52.753Z] >>> [apiv2][query] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip GoogleAccessId=service-200647345557%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216952&Signature=rzalngRaKbfsqrxMk3LTE%2BZma%2BWDb1vZmsqIM27kTMKCZCS0A1i4nyGw2RcT2PM4npFYGpGwpTWAuaopmoykohU0iX%2F6XuD23EwtP6LQ7cr9AfSCOso1t3mkpZypCF0%2FaL%2BQyejkPkHWf6AC%2BTsXCSSyNp3DEl3t3VWPLoO7ylnctwNaow9b8x62seJM%2BepAdKFwVG0tUSyjDtugOnoUiouvxHPm2k44fTFQn2kaG7nn7VwCOWkpJPQlXa1pv%2ByeBwel703JXuN4qf%2BPzxHLSE1WMUa8ZFtrAG5u4tNGrkST2lzIMf%2BrF0kLWd1322D7ErJFath2tW0Gfy9P0n5Csg%3D%3D
[debug] [2022-09-03T14:25:52.753Z] >>> [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip [stream]
[debug] [2022-09-03T14:25:53.467Z] <<< [apiv2][status] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip 200
[debug] [2022-09-03T14:25:53.467Z] <<< [apiv2][body] PUT https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip [omitted]
[info] ✔  functions: functions folder uploaded successfully 
[info] i  functions: creating Node.js 14 function sendNotification(us-central1)... 
[debug] [2022-09-03T14:25:53.473Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions [none]
[debug] [2022-09-03T14:25:53.473Z] >>> [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"name":"projects/evidens-ec6bd/locations/us-central1/functions/sendNotification","sourceUploadUrl":"https://storage.googleapis.com/uploads-514818952534.us-central1.cloudfunctions.appspot.com/9d61629e-be4e-4409-916a-0e2e95d7fba1.zip?GoogleAccessId=service-200647345557@gcf-admin-robot.iam.gserviceaccount.com&Expires=1662216952&Signature=rzalngRaKbfsqrxMk3LTE%2BZma%2BWDb1vZmsqIM27kTMKCZCS0A1i4nyGw2RcT2PM4npFYGpGwpTWAuaopmoykohU0iX%2F6XuD23EwtP6LQ7cr9AfSCOso1t3mkpZypCF0%2FaL%2BQyejkPkHWf6AC%2BTsXCSSyNp3DEl3t3VWPLoO7ylnctwNaow9b8x62seJM%2BepAdKFwVG0tUSyjDtugOnoUiouvxHPm2k44fTFQn2kaG7nn7VwCOWkpJPQlXa1pv%2ByeBwel703JXuN4qf%2BPzxHLSE1WMUa8ZFtrAG5u4tNGrkST2lzIMf%2BrF0kLWd1322D7ErJFath2tW0Gfy9P0n5Csg%3D%3D","entryPoint":"sendNotification","runtime":"nodejs14","dockerRegistry":"ARTIFACT_REGISTRY","labels":{"deployment-tool":"cli-firebase"},"eventTrigger":{"eventType":"providers/cloud.firestore/eventTypes/document.create","resource":"projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"},"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}","GCLOUD_PROJECT":"evidens-ec6bd"}}
[debug] [2022-09-03T14:25:53.827Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions 400
[debug] [2022-09-03T14:25:53.827Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v1/projects/evidens-ec6bd/locations/us-central1/functions {"error":{"code":400,"message":"The request has errors","status":"INVALID_ARGUMENT","details":[{"@type":"type.googleapis.com/google.rpc.BadRequest","fieldViolations":[{"field":"event_trigger","description":"Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"}]}]}}
[warn] ⚠  functions: failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification 
[error] Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:25:53.835Z] Total Function Deployment time: 359
[debug] [2022-09-03T14:25:53.835Z] 1 Functions Deployed
[debug] [2022-09-03T14:25:53.835Z] 1 Functions Errored
[debug] [2022-09-03T14:25:53.835Z] 0 Function Deployments Aborted
[debug] [2022-09-03T14:25:53.835Z] Average Function Deployment time: 358
[info] 
[info] Functions deploy had errors with the following functions:
	sendNotification(us-central1)
[info] i  functions: cleaning up build files... 
[debug] [2022-09-03T14:25:53.935Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email [none]
[debug] [2022-09-03T14:25:53.936Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete [none]
[debug] [2022-09-03T14:25:53.937Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification [none]
[debug] [2022-09-03T14:25:53.938Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create [none]
[debug] [2022-09-03T14:25:53.938Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create [none]
[debug] [2022-09-03T14:25:53.939Z] >>> [apiv2][query] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update [none]
[debug] [2022-09-03T14:25:53.940Z] >>> [apiv2][query] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list [none]
[debug] [2022-09-03T14:25:54.545Z] <<< [apiv2][status] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list 200
[debug] [2022-09-03T14:25:54.545Z] <<< [apiv2][body] GET https://us.gcr.io/v2/evidens-ec6bd/gcf/us-central1/tags/list {"child":[],"manifest":{},"name":"evidens-ec6bd/gcf/us-central1","tags":[]}
[debug] [2022-09-03T14:25:54.545Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendWelcomeEmail
[debug] [2022-09-03T14:25:54.546Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnDelete
[debug] [2022-09-03T14:25:54.546Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification
[debug] [2022-09-03T14:25:54.546Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/postOnCreate
[debug] [2022-09-03T14:25:54.546Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/caseOnCreate
[debug] [2022-09-03T14:25:54.546Z] Could not find image for function projects/evidens-ec6bd/locations/us-central1/functions/userOnUpdate
[debug] [2022-09-03T14:25:54.910Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification 404
[debug] [2022-09-03T14:25:54.911Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_notification\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.911Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create 404
[debug] [2022-09-03T14:25:54.911Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/case_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.911Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create 404
[debug] [2022-09-03T14:25:54.911Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_create\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.912Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete 404
[debug] [2022-09-03T14:25:54.912Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/post_on_delete\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.912Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email 404
[debug] [2022-09-03T14:25:54.912Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/send_welcome_email\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.913Z] <<< [apiv2][status] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update 404
[debug] [2022-09-03T14:25:54.913Z] <<< [apiv2][body] DELETE https://artifactregistry.googleapis.com/v1beta2/projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update {"error":{"code":404,"message":"Package \"projects/evidens-ec6bd/locations/us-central1/repositories/gcf-artifacts/packages/user_on_update\" was not found.","status":"NOT_FOUND"}}
[debug] [2022-09-03T14:25:54.913Z] Functions deploy failed.
[debug] [2022-09-03T14:25:54.913Z] {
  "endpoint": {
    "id": "sendNotification",
    "project": "evidens-ec6bd",
    "region": "us-central1",
    "entryPoint": "sendNotification",
    "platform": "gcfv1",
    "runtime": "nodejs14",
    "eventTrigger": {
      "eventType": "providers/cloud.firestore/eventTypes/document.create",
      "retry": false,
      "eventFilters": {
        "resource": "projects/evidens-ec6bd/databases/(default)/documents/notifications/{uid}/user-notifications"
      }
    },
    "environmentVariables": {
      "FIREBASE_CONFIG": "{\"projectId\":\"evidens-ec6bd\",\"databaseURL\":\"https://evidens-ec6bd-default-rtdb.europe-west1.firebasedatabase.app\",\"storageBucket\":\"evidens-ec6bd.appspot.com\",\"locationId\":\"europe-west\"}",
      "GCLOUD_PROJECT": "evidens-ec6bd"
    },
    "codebase": "default",
    "labels": {
      "deployment-tool": "cli-firebase"
    }
  },
  "op": "create",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "context": {
      "function": "projects/evidens-ec6bd/locations/us-central1/functions/sendNotification"
    },
    "exit": 1,
    "message": "Failed to create function projects/evidens-ec6bd/locations/us-central1/functions/sendNotification",
    "original": {
      "name": "FirebaseError",
      "children": [],
      "context": {
        "body": {
          "error": {
            "code": 400,
            "message": "The request has errors",
            "status": "INVALID_ARGUMENT",
            "details": [
              {
                "@type": "type.googleapis.com/google.rpc.BadRequest",
                "fieldViolations": [
                  {
                    "field": "event_trigger",
                    "description": "Expected value notifications/{uid}/user-notifications to match regular expression [^/]+/[^/]+(/[^/]+/[^/]+)*"
                  }
                ]
              }
            ]
          }
        },
        "response": {
          "statusCode": 400
        }
      },
      "exit": 1,
      "message": "HTTP Error: 400, The request has errors",
      "status": 400
    },
    "status": 500
  }
}
[debug] [2022-09-03T14:25:55.064Z] Error: Failed to create function sendNotification in region us-central1
    at /Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:42:11
    at processTicksAndRejections (node:internal/process/task_queues:96:5)
    at async Fabricator.createV1Function (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:169:32)
    at async Fabricator.createEndpoint (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:120:13)
    at async handle (/Users/pau/.cache/firebase/tools/lib/node_modules/firebase-tools/lib/deploy/functions/release/fabricator.js:79:17)
[error] 
[error] Error: There was an error deploying functions
